10 BORDER 7: PAPER 7: INK 0: CLS
15 POKE 23658,8
20 LET BUFFER=50000: LET SUMA=9999
30 GO SUB 999

40 PRINT AT YPROTA, XPROTA; PAPER 2;INK 0;OVER 1;" ": REM PRINT AT 0,0;XPROTA;" ";YPROTA: PRINT AT 0,20;"    "; AT 0,20;SUMA
45 IF SUMA=0 THEN PRINT AT 0,0;FLASH 1;"TERMINADO": STOP
55 LET A$=INKEY$
60 IF A$="O" AND XPROTA>XBOARD AND PEEK (PUNTERO-1)>=PEEK PUNTERO AND PEEK (PUNTERO-1)>0 THEN LET SUMA=SUMA-PEEK (PUNTERO-1): POKE PUNTERO,0: LET PUNTERO=PUNTERO-1: LET XPROTA=XPROTA-1: GO TO 40
65 IF A$="P" AND XPROTA<(XBOARD+XANCHO)-1 AND PEEK (PUNTERO+1)>=PEEK PUNTERO AND PEEK (PUNTERO+1)>0 THEN LET SUMA=SUMA-PEEK (PUNTERO+1): POKE PUNTERO,0: LET PUNTERO=PUNTERO+1: LET XPROTA=XPROTA+1: GO TO 40
70 IF A$="A" AND YPROTA<(YBOARD+YALTO)-1 AND PEEK (PUNTERO+XANCHO)>=PEEK PUNTERO AND PEEK (PUNTERO+XANCHO)>0 THEN LET SUMA=SUMA-PEEK (PUNTERO+XANCHO): POKE PUNTERO,0: LET PUNTERO=PUNTERO+XANCHO: LET YPROTA=YPROTA+1: GO TO 40
75 IF A$="Q" AND YPROTA>YBOARD AND PEEK (PUNTERO-XANCHO)>=PEEK PUNTERO AND PEEK (PUNTERO-XANCHO)>0 THEN LET SUMA=SUMA-PEEK (PUNTERO-XANCHO): POKE PUNTERO,0: LET PUNTERO=PUNTERO-XANCHO: LET YPROTA=YPROTA-1: GO TO 40
80 IF A$="R" THEN RUN
90 GO TO 50

999 RESTORE 1155
1000 READ A: LET XANCHO=A: READ A: LET YALTO=A
1002 READ A: LET XBOARD=A: READ A: LET YBOARD=A
1004 READ A: LET XPROTA=XBOARD+A: READ A: LET YPROTA=YBOARD+A
1006 LET SUMA=0: LET CONTADOR=0: FOR Y=YBOARD TO (YBOARD+YALTO)-1: FOR X = XBOARD TO (XBOARD+XANCHO)-1
1010 READ A
1014 POKE BUFFER+CONTADOR,A
1015 IF A=0 THEN GO TO 1018
1016 IF A=44 THEN LET A=0: POKE 60000+CONTADOR,A: LET PUNTERO = CONTADOR+BUFFER: POKE PUNTERO,A: PRINT AT YPROTA, XPROTA; PAPER 2;INK 0;"X": GO TO 1018
1017 PRINT AT Y,X;A
1018 LET CONTADOR=CONTADOR+1: LET SUMA=SUMA+A
1020 NEXT X
1022 NEXT Y
1097 RETURN


1111 DATA 3,4 : REM ANCHO Y ALTO DEL TABLERO
1112 DATA 2,2 : REM COORDENADAS DE IMPRESION DEL TABLERO X E Y
1113 DATA 2,0 : REM OFFSET DE INICIO DEL PROTA X E Y
1130 DATA 3,0,44,3,2,1,3,2,2,3,2,2

1150 DATA 4,5
1151 DATA 13,2
1152 DATA 0,2
1153 DATA 0,2,2,2,0,2,2,2,44,1,2,9,0,2,2,8,0,2,2,7

1155 DATA 5,5
1156 DATA 13,4
1157 DATA 2,2
1158 DATA 4,4,4,4,4,4,2,2,2,4,4,2,44,4,4,4,2,2,4,4,4,4,4,6,8